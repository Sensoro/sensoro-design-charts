"use strict";(self.webpackChunksensoro_design_charts=self.webpackChunksensoro_design_charts||[]).push([["6958"],{55457:function(e,t,l){l.r(t),l.d(t,{default:()=>p});var n=l(52676),r=l(90565),a=l(75271);function o(e,t,l){if("function"==typeof l.getChildrenKey){let n=l.getChildrenKey(e,t);if(null!=n)return n}return l.childrenKey}let i=(e,t,l)=>{t(e,l);let n=o(e,l,l),r=e[n];if(r&&Array.isArray(r)){let n={...l,parents:[...l.parents,e],depth:l.depth+1};r.forEach(e=>{i(e,t,n)})}},u=(e,t,l)=>{let n=o(e,l,l),r=e[n];if(r&&Array.isArray(r)){let n={...l,parents:[...l.parents,e],depth:l.depth+1};r.forEach(e=>{u(e,t,n)})}t(e,l)},s={pre:i,post:u,breadth:(e,t,l)=>{let n=[{tree:e,options:l}],r=()=>{if(0===n.length)return;let e=n.shift(),l=e.tree,a=o(l,e.options,e.options);if(l[a]&&Array.isArray(l[a])){let t={...e.options,parents:[...e.options.parents,l],depth:e.options.depth+1},r=l[a].map(e=>({tree:e,options:t}));n.push(...r)}t(l,e.options),r()};r()}},d=[{nodes:[{name:"今日巡航次数",value:160,total:1087875,children:[{name:"公共安全",value:40,total:287875,children:[{name:"高风险",value:10,total:18764},{name:"中风险",value:10,total:22329},{name:"低风险",value:10,total:43093},{name:"无风险",value:10,total:763875}]},{name:"交通安全",value:40,total:200653,children:[{name:"高风险",value:10,total:18764},{name:"中风险",value:10,total:22329},{name:"低风险",value:10,total:43093},{name:"无风险",value:10,total:763875}]},{name:"市容市政",value:40,total:406765,children:[{name:"高风险",value:10,total:18764},{name:"中风险",value:10,total:22329},{name:"低风险",value:10,total:43093},{name:"无风险",value:10,total:763875}]},{name:"城市秩序",value:40,total:82854,children:[{name:"高风险",value:10,total:18764},{name:"中风险",value:10,total:22329},{name:"低风险",value:10,total:43093},{name:"无风险",value:10,total:763875}]}]}]}],c=["#423CD1","#E7474D","#E7AF2C","#51C2E1","#3AC583"],h={今日巡航次数:c[0],公共安全:c[0],交通安全:c[0],市容市政:c[0],城市秩序:c[0],高风险:c[1],中风险:c[2],低风险:c[3],无风险:c[4]};function f(e){let{style:t}=e;return(0,n.jsx)("div",{style:{position:"absolute",width:"100px",visibility:"hidden",backdropFilter:"blur(20px)",background:"rgba(49,64,89,0.35)",padding:16,top:0,left:0,...t},children:"我是 Tooltip"})}let p=function(){let e=a.useRef(null),t=a.useRef(),l=a.useRef(null),[o,i]=a.useState({}),u=()=>{let t=e.current;l.current&&(clearInterval(l.current),l.current=null),l.current&&clearInterval(l.current),t&&t.setHovered(null)},p=()=>{let t=e.current,n=[];!function(e,t,l){var n,r;let a=null!=(n=null==l?void 0:l.childrenKey)?n:"children",o=null!=(r=null==l?void 0:l.strategy)?r:"pre",i=null==l?void 0:l.getChildrenKey,u=Array.isArray(e),d=s[o],c={childrenKey:a,depth:0,parents:[],getChildrenKey:i};u?e.forEach(e=>{d(e,t,c)}):d(e,t,c)}(d[0].nodes,e=>{let t=e.name;n.includes(t)||"今日巡航次数"===t||n.push(t)},{strategy:"breadth"}),t&&(u(),l.current=setInterval(()=>{let e=function(e){if(0===e.length)return null;let t=Math.floor(Math.random()*e.length);return e[t]}(n);e&&t.setHovered([{name:e}])},2e3))},v=()=>{u()},m=()=>{p()};return a.useEffect(()=>(t.current=setTimeout(()=>{console.log(e.current);let t=e.current;t&&(p(),t.on("pointerenter",{level:"chart"},v),t.on("pointerleave",{level:"chart"},m),t.setTooltipHandler({showTooltip:(e,t,l)=>{if(i(e=>({...e,left:l.event.x+30,top:l.event.y+30})),!l.changePositionOnly)return i(e=>({...e,visibility:"visible"})),0},hideTooltip:()=>(i(e=>({...e,visibility:"hidden"})),0),release:()=>{}}))},500),()=>{e.current&&(e.current.off("pointerenter",v),e.current.off("pointerleave",m)),t.current&&clearTimeout(t.current),u()}),[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.bQ,{height:600,data:[{values:d}],color:{type:"ordinal",range:c,domain:[],specified:h},categoryField:"name",valueField:"value",nodeAlign:"left",nodeWidth:4,nodeKey:e=>e.name,nodeHeight:e=>0===e.depth?160:40,label:{visible:!0,offset:8,formatMethod(e,t){var l;return`${null==t?void 0:t.name} ${null==t?void 0:null===(l=t.total)||void 0===l?void 0:l.toLocaleString()}`},style:{fill:"#F6F9FE",fontSize:12}},link:{style:{fillOpacity:.3,fill:e=>({gradient:"linear",x0:.2,y0:.5,x1:1,y1:1,stops:[{offset:0,color:h[null==e?void 0:e.source]},{offset:1,color:h[null==e?void 0:e.target]}]})},state:{selected:{fillOpacity:1}}},emphasis:{enable:!0,trigger:"hover",effect:"related"},skipFunctionDiff:!0,ref:e}),(0,n.jsx)(f,{style:o})]})}}}]);